<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PL-300: Microsoft Power BI Data Analyst - Curso Interactivo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f7b731 0%, #f79f1f 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #f7b731 0%, #f79f1f 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .nav-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
            overflow-x: auto;
        }

        .nav-tab {
            padding: 15px 25px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 1em;
            font-weight: 500;
            color: #666;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .nav-tab:hover {
            background: #e9ecef;
            color: #333;
        }

        .nav-tab.active {
            background: white;
            color: #f7b731;
            border-bottom: 3px solid #f7b731;
        }

        .content {
            padding: 40px;
        }

        .tab-pane {
            display: none;
        }

        .tab-pane.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #f7b731 0%, #f79f1f 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(247, 183, 49, 0.3);
        }

        .stat-card .label {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .stat-card .value {
            font-size: 2.5em;
            font-weight: bold;
        }

        .module-section {
            margin-bottom: 40px;
        }

        .module-header {
            background: linear-gradient(135deg, #f7b731 0%, #f79f1f 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 1.3em;
            font-weight: bold;
        }

        .lesson-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .lesson-card {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .lesson-card:hover {
            border-color: #f7b731;
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(247, 183, 49, 0.2);
        }

        .lesson-card.completed {
            border-color: #28a745;
            background: #d4edda;
        }

        .lesson-card h3 {
            color: #f7b731;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .lesson-card .status {
            font-size: 1.5em;
        }

        .lesson-card p {
            color: #666;
            font-size: 0.95em;
        }

        .quiz-question {
            background: #f8f9fa;
            border-left: 4px solid #f7b731;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 5px;
        }

        .question-number {
            font-weight: bold;
            color: #f7b731;
            margin-bottom: 10px;
        }

        .question-text {
            font-size: 1.1em;
            margin-bottom: 15px;
            font-weight: 500;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .quiz-option {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .quiz-option:hover {
            border-color: #f7b731;
            background: #fff9e6;
        }

        .quiz-option input[type="radio"] {
            cursor: pointer;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #f7b731 0%, #f79f1f 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(247, 183, 49, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .progress-bar-container {
            background: #e9ecef;
            border-radius: 10px;
            height: 30px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-bar {
            background: linear-gradient(135deg, #f7b731 0%, #f79f1f 100%);
            height: 100%;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .quiz-result {
            background: #d4edda;
            border: 2px solid #28a745;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            margin-top: 20px;
        }

        .quiz-result h2 {
            color: #28a745;
            margin-bottom: 15px;
        }

        .quiz-result .score {
            font-size: 3em;
            font-weight: bold;
            color: #28a745;
            margin: 20px 0;
        }

        .activity-timeline {
            margin-top: 30px;
        }

        .activity-item {
            border-left: 3px solid #f7b731;
            padding-left: 20px;
            margin-bottom: 20px;
            position: relative;
        }

        .activity-item::before {
            content: '‚óè';
            position: absolute;
            left: -8px;
            color: #f7b731;
            font-size: 1.2em;
        }

        .activity-item .time {
            font-size: 0.9em;
            color: #666;
        }

        .export-section {
            margin-top: 30px;
        }

        .export-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .section-title {
            color: #f7b731;
            font-size: 1.8em;
            margin-bottom: 20px;
            border-bottom: 3px solid #f7b731;
            padding-bottom: 10px;
        }

        .objectives-list {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            margin: 20px 0;
        }

        .objectives-list ul {
            list-style: none;
            padding: 0;
        }

        .objectives-list li {
            padding: 10px 0;
            padding-left: 30px;
            position: relative;
        }

        .objectives-list li::before {
            content: '‚úì';
            position: absolute;
            left: 0;
            color: #28a745;
            font-weight: bold;
            font-size: 1.2em;
        }

        .lab-card {
            background: #fff;
            border: 2px solid #f7b731;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .lab-card h3 {
            color: #f7b731;
            margin-bottom: 15px;
        }

        .lab-steps {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin-top: 10px;
        }

        .lab-steps ol {
            margin-left: 20px;
        }

        .lab-steps li {
            margin: 8px 0;
        }

        .dataset-info {
            background: #e7f3ff;
            border-left: 4px solid #0066cc;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }

        .dataset-info code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }

            .content {
                padding: 20px;
            }

            .lesson-grid {
                grid-template-columns: 1fr;
            }

            .stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>PL-300: Microsoft Power BI Data Analyst</h1>
            <p>Curso Interactivo Completo</p>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" data-tab="overview">ÔøΩÔøΩ Resumen</button>
            <button class="nav-tab" data-tab="lessons">üìñ Lecciones</button>
            <button class="nav-tab" data-tab="labs">üß™ Laboratorios</button>
            <button class="nav-tab" data-tab="quiz">‚ùì Cuestionario</button>
            <button class="nav-tab" data-tab="progress">üìä Progreso</button>
        </div>

        <div class="content">
            <!-- Overview Tab -->
            <div id="overview" class="tab-pane active">
                <h2 class="section-title">Resumen del Curso</h2>
                
                <div class="stats">
                    <div class="stat-card">
                        <div class="label">Lecciones Completadas</div>
                        <div class="value" id="completedCount">0/28</div>
                    </div>
                    <div class="stat-card">
                        <div class="label">Puntuaci√≥n del Cuestionario</div>
                        <div class="value" id="quizScore">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="label">Progreso Total</div>
                        <div class="value" id="totalProgress">0%</div>
                    </div>
                </div>

                <div class="objectives-list">
                    <h3>Objetivos de Aprendizaje</h3>
                    <ul>
                        <li>Preparar datos para an√°lisis mediante Power Query</li>
                        <li>Crear modelos de datos con relaciones y medidas DAX</li>
                        <li>Dise√±ar visualizaciones efectivas e informes interactivos</li>
                        <li>Crear dashboards y reportes compartibles</li>
                        <li>Implementar seguridad a nivel de fila (RLS)</li>
                        <li>Administrar √°reas de trabajo y conjuntos de datos</li>
                        <li>Optimizar el rendimiento de modelos y consultas</li>
                        <li>Implementar buenas pr√°cticas de dise√±o y gobernanza</li>
                    </ul>
                </div>

                <div class="objectives-list">
                    <h3>Estructura del Curso</h3>
                    <ul>
                        <li><strong>M√≥dulo 1:</strong> Preparar los Datos (7 lecciones)</li>
                        <li><strong>M√≥dulo 2:</strong> Modelar los Datos (7 lecciones)</li>
                        <li><strong>M√≥dulo 3:</strong> Visualizar y Analizar los Datos (7 lecciones)</li>
                        <li><strong>M√≥dulo 4:</strong> Implementar y Administrar (7 lecciones)</li>
                    </ul>
                </div>
            </div>

            <!-- Lessons Tab -->
            <div id="lessons" class="tab-pane">
                <h2 class="section-title">Lecciones del Curso</h2>
                
                <div class="progress-bar-container">
                    <div class="progress-bar" id="lessonProgress" style="width: 0%">0%</div>
                </div>

                <div id="lessonsContainer"></div>
            </div>

            <!-- Labs Tab -->
            <div id="labs" class="tab-pane">
                <h2 class="section-title">Laboratorios Pr√°cticos</h2>

                <div class="dataset-info">
                    <h3>üìÅ Conjunto de Datos Incluido</h3>
                    <p>Este curso incluye un conjunto de datos de muestra: <code>data/sales_sample.csv</code></p>
                    <p><strong>Columnas:</strong> OrderID, OrderDate, Customer, Product, Category, Quantity, UnitPrice, TotalPrice</p>
                    <p><strong>Filas:</strong> 10 registros de ventas de ejemplo</p>
                </div>

                <div class="lab-card">
                    <h3>üß™ Lab 1: Importar y Transformar Datos</h3>
                    <p><strong>Duraci√≥n estimada:</strong> 30 minutos</p>
                    <p><strong>Objetivo:</strong> Aprender a importar datos desde CSV y realizar transformaciones b√°sicas en Power Query.</p>
                    <div class="lab-steps">
                        <h4>Pasos:</h4>
                        <ol>
                            <li>Abre Power BI Desktop</li>
                            <li>Selecciona "Obtener datos" ‚Üí "Texto/CSV"</li>
                            <li>Navega a <code>data/sales_sample.csv</code> y c√°rgalo</li>
                            <li>En el Editor de Power Query:
                                <ul>
                                    <li>Cambia el tipo de datos de OrderDate a Fecha</li>
                                    <li>Verifica que Quantity sea N√∫mero Entero</li>
                                    <li>Verifica que UnitPrice y TotalPrice sean N√∫mero Decimal</li>
                                </ul>
                            </li>
                            <li>Agrega una columna calculada: Month = MONTH(OrderDate)</li>
                            <li>Aplica los cambios y cierra el Editor de Power Query</li>
                        </ol>
                    </div>
                </div>

                <div class="lab-card">
                    <h3>üß™ Lab 2: Crear Medidas DAX</h3>
                    <p><strong>Duraci√≥n estimada:</strong> 45 minutos</p>
                    <p><strong>Objetivo:</strong> Crear medidas DAX para an√°lisis de ventas.</p>
                    <div class="lab-steps">
                        <h4>Medidas a Crear:</h4>
                        <ol>
                            <li><strong>Total Ventas:</strong> <code>Total Ventas = SUM(Sales[TotalPrice])</code></li>
                            <li><strong>Total Cantidad:</strong> <code>Total Cantidad = SUM(Sales[Quantity])</code></li>
                            <li><strong>Promedio Precio:</strong> <code>Precio Promedio = AVERAGE(Sales[UnitPrice])</code></li>
                            <li><strong>Conteo Pedidos:</strong> <code>Conteo Pedidos = COUNTROWS(Sales)</code></li>
                            <li><strong>Ticket Promedio:</strong> <code>Ticket Promedio = [Total Ventas] / [Conteo Pedidos]</code></li>
                        </ol>
                    </div>
                </div>

                <div class="lab-card">
                    <h3>üß™ Lab 3: Dise√±ar Dashboard de Ventas</h3>
                    <p><strong>Duraci√≥n estimada:</strong> 60 minutos</p>
                    <p><strong>Objetivo:</strong> Crear un dashboard interactivo con visualizaciones clave.</p>
                    <div class="lab-steps">
                        <h4>Visualizaciones a Crear:</h4>
                        <ol>
                            <li><strong>Tarjeta:</strong> Total Ventas</li>
                            <li><strong>Tarjeta:</strong> Total Cantidad</li>
                            <li><strong>Gr√°fico de Barras:</strong> Ventas por Categor√≠a</li>
                            <li><strong>Gr√°fico de L√≠neas:</strong> Ventas por Fecha</li>
                            <li><strong>Tabla:</strong> Top 5 Productos por Ventas</li>
                            <li><strong>Segmentador:</strong> Por Cliente</li>
                            <li><strong>Segmentador:</strong> Por Categor√≠a</li>
                        </ol>
                    </div>
                </div>

                <div class="lab-card">
                    <h3>üß™ Lab 4: Publicar y Compartir</h3>
                    <p><strong>Duraci√≥n estimada:</strong> 30 minutos</p>
                    <p><strong>Objetivo:</strong> Publicar el informe en Power BI Service y configurar compartici√≥n.</p>
                    <div class="lab-steps">
                        <h4>Pasos:</h4>
                        <ol>
                            <li>Guarda tu archivo .pbix localmente</li>
                            <li>Haz clic en "Publicar" en la cinta de opciones</li>
                            <li>Selecciona un √°rea de trabajo destino</li>
                            <li>Abre Power BI Service en el navegador</li>
                            <li>Configura la actualizaci√≥n de datos (si aplica)</li>
                            <li>Crea un dashboard anclando visualizaciones</li>
                            <li>Comparte el dashboard con usuarios espec√≠ficos</li>
                        </ol>
                    </div>
                </div>
            </div>

            <!-- Quiz Tab -->
            <div id="quiz" class="tab-pane">
                <h2 class="section-title">Cuestionario de Evaluaci√≥n</h2>
                <form id="quizForm">
                    <div id="quizQuestions"></div>
                    <button type="submit" class="btn btn-primary" style="margin-top: 20px;">Enviar Respuestas</button>
                </form>
                <div id="quizResult" style="display: none;"></div>
            </div>

            <!-- Progress Tab -->
            <div id="progress" class="tab-pane">
                <h2 class="section-title">Tu Progreso</h2>
                
                <div class="stats">
                    <div class="stat-card">
                        <div class="label">Lecciones Completadas</div>
                        <div class="value" id="progressCompletedCount">0/28</div>
                    </div>
                    <div class="stat-card">
                        <div class="label">Mejor Puntuaci√≥n</div>
                        <div class="value" id="progressBestScore">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="label">Intentos de Cuestionario</div>
                        <div class="value" id="progressQuizAttempts">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="label">Progreso Global</div>
                        <div class="value" id="progressOverall">0%</div>
                    </div>
                </div>

                <div class="activity-timeline">
                    <h3>Actividad Reciente</h3>
                    <div id="activityLog"></div>
                </div>

                <div class="export-section">
                    <h3>Exportar Progreso</h3>
                    <div class="export-buttons">
                        <button class="btn btn-primary" onclick="exportAsJSON()">üì• Exportar como JSON</button>
                        <button class="btn btn-primary" onclick="exportAsCSV()">üì• Exportar como CSV</button>
                        <button class="btn btn-danger" onclick="clearProgress()">üóëÔ∏è Limpiar Todo el Progreso</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Course Data Object
        const COURSE = {
            modules: [
                {
                    id: 1,
                    name: 'Preparar los Datos',
                    lessons: [
                        { id: 1, title: 'Obtener Datos de Archivos y Excel', description: 'Aprende a conectarte a diferentes fuentes de datos planos' },
                        { id: 2, title: 'Conectar a Bases de Datos SQL', description: 'Conexi√≥n a SQL Server y otras bases de datos relacionales' },
                        { id: 3, title: 'Transformar Datos con Power Query', description: 'Uso del Editor de Power Query para transformaciones' },
                        { id: 4, title: 'Limpiar y Dar Forma a los Datos', description: 'T√©cnicas de limpieza y preparaci√≥n de datos' },
                        { id: 5, title: 'Combinar y Anexar Consultas', description: 'Merge y Append para unir datos de m√∫ltiples fuentes' },
                        { id: 6, title: 'Par√°metros y Consultas Din√°micas', description: 'Crear consultas reutilizables con par√°metros' },
                        { id: 7, title: 'Optimizar Rendimiento de Consultas', description: 'Mejores pr√°cticas para consultas eficientes' }
                    ]
                },
                {
                    id: 2,
                    name: 'Modelar los Datos',
                    lessons: [
                        { id: 8, title: 'Dise√±ar un Modelo de Datos', description: 'Principios de dise√±o de modelos estrella y copo de nieve' },
                        { id: 9, title: 'Crear Relaciones entre Tablas', description: 'Configurar relaciones uno a muchos y muchos a muchos' },
                        { id: 10, title: 'Cardinalidad y Direcciones de Filtro', description: 'Entender y configurar relaciones bidireccionales' },
                        { id: 11, title: 'Crear Columnas Calculadas', description: 'Usar DAX para columnas calculadas' },
                        { id: 12, title: 'Medidas DAX B√°sicas', description: 'Funciones de agregaci√≥n: SUM, AVERAGE, COUNT, MIN, MAX' },
                        { id: 13, title: 'DAX Avanzado y Time Intelligence', description: 'C√°lculos de per√≠odo, YTD, MTD, comparaciones' },
                        { id: 14, title: 'Optimizar Modelos para Rendimiento', description: 'Reducir tama√±o de modelo y mejorar velocidad de consultas' }
                    ]
                },
                {
                    id: 3,
                    name: 'Visualizar y Analizar los Datos',
                    lessons: [
                        { id: 15, title: 'Seleccionar Visualizaciones Apropiadas', description: 'Elegir el tipo correcto de gr√°fico para tus datos' },
                        { id: 16, title: 'Formatear y Configurar Visualizaciones', description: 'Personalizar colores, etiquetas y estilos' },
                        { id: 17, title: 'Usar Visualizaciones Personalizadas', description: 'Importar visuales desde AppSource' },
                        { id: 18, title: 'Crear y Formatear Informes', description: 'Dise√±o de p√°ginas de informe efectivas' },
                        { id: 19, title: 'Dise√±o para Dispositivos M√≥viles', description: 'Optimizar informes para tel√©fonos y tablets' },
                        { id: 20, title: 'Implementar Dashboards', description: 'Crear dashboards con visualizaciones clave' },
                        { id: 21, title: 'Crear Informes Paginados', description: 'Informes con formato de impresi√≥n usando Power BI Report Builder' }
                    ]
                },
                {
                    id: 4,
                    name: 'Implementar y Administrar',
                    lessons: [
                        { id: 22, title: 'Crear y Administrar √Åreas de Trabajo', description: 'Configurar workspaces en Power BI Service' },
                        { id: 23, title: 'Publicar y Compartir Informes', description: 'Publicar contenido y configurar permisos' },
                        { id: 24, title: 'Configurar Actualizaci√≥n de Datos', description: 'Programar actualizaciones autom√°ticas de conjuntos de datos' },
                        { id: 25, title: 'Implementar Seguridad a Nivel de Fila', description: 'Configurar RLS para filtrado de datos por usuario' },
                        { id: 26, title: 'Configurar Aplicaciones de Power BI', description: 'Crear y distribuir aplicaciones a usuarios' },
                        { id: 27, title: 'Monitorear Uso y Rendimiento', description: 'Usar m√©tricas de uso y optimizar rendimiento' },
                        { id: 28, title: 'Solucionar Problemas y Optimizar', description: 'Diagn√≥stico y resoluci√≥n de problemas comunes' }
                    ]
                }
            ],
            quiz: [
                {
                    id: 1,
                    question: '¬øCu√°l es la herramienta principal para transformar datos en Power BI?',
                    options: ['DAX Studio', 'Power Query', 'Excel', 'SQL Server'],
                    correct: 1
                },
                {
                    id: 2,
                    question: '¬øQu√© lenguaje se usa para crear medidas calculadas en Power BI?',
                    options: ['SQL', 'M', 'DAX', 'Python'],
                    correct: 2
                },
                {
                    id: 3,
                    question: '¬øCu√°l es el tipo de relaci√≥n m√°s com√∫n en un modelo de datos?',
                    options: ['Muchos a muchos', 'Uno a uno', 'Uno a muchos', 'Ninguna relaci√≥n'],
                    correct: 2
                },
                {
                    id: 4,
                    question: '¬øQu√© funci√≥n DAX se usa para sumar valores?',
                    options: ['SUM()', 'TOTAL()', 'ADD()', 'SUMX()'],
                    correct: 0
                },
                {
                    id: 5,
                    question: '¬øCu√°l es el prop√≥sito de RLS (Row-Level Security)?',
                    options: ['Mejorar rendimiento', 'Filtrar datos por usuario', 'Crear relaciones', 'Optimizar consultas'],
                    correct: 1
                },
                {
                    id: 6,
                    question: '¬øQu√© es un modelo de datos estrella?',
                    options: ['Un tipo de visualizaci√≥n', 'Un esquema con tabla de hechos central y tablas de dimensiones', 'Una medida DAX', 'Un tipo de relaci√≥n'],
                    correct: 1
                },
                {
                    id: 7,
                    question: '¬øD√≥nde se publican los informes de Power BI Desktop?',
                    options: ['SharePoint', 'OneDrive', 'Power BI Service', 'Azure'],
                    correct: 2
                },
                {
                    id: 8,
                    question: '¬øQu√© tipo de actualizaci√≥n permite actualizar datos autom√°ticamente?',
                    options: ['Actualizaci√≥n manual', 'Actualizaci√≥n programada', 'Actualizaci√≥n en vivo', 'Actualizaci√≥n incremental'],
                    correct: 1
                },
                {
                    id: 9,
                    question: '¬øCu√°l es la diferencia entre columna calculada y medida?',
                    options: ['No hay diferencia', 'Columna calculada se calcula por fila, medida se agrega', 'Medida es m√°s r√°pida', 'Columna calculada usa SQL'],
                    correct: 1
                },
                {
                    id: 10,
                    question: '¬øQu√© visualizaci√≥n es mejor para mostrar tendencias en el tiempo?',
                    options: ['Gr√°fico circular', 'Tabla', 'Gr√°fico de l√≠neas', 'Tarjeta'],
                    correct: 2
                }
            ]
        };

        // Local Storage Keys
        const STORAGE_KEYS = {
            completed: 'pl300-completed',
            results: 'pl300-results'
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            renderLessons();
            renderQuiz();
            updateStats();
            updateProgressTab();
            setupTabNavigation();
        });

        // Tab Navigation
        function setupTabNavigation() {
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const targetTab = this.getAttribute('data-tab');
                    
                    // Update active tab
                    document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Update active pane
                    document.querySelectorAll('.tab-pane').forEach(p => p.classList.remove('active'));
                    document.getElementById(targetTab).classList.add('active');
                    
                    // Update progress tab when switching to it
                    if (targetTab === 'progress') {
                        updateProgressTab();
                    }
                });
            });
        }

        // Render Lessons
        function renderLessons() {
            const container = document.getElementById('lessonsContainer');
            container.innerHTML = '';
            
            const completed = getCompleted();
            
            COURSE.modules.forEach(module => {
                const moduleSection = document.createElement('div');
                moduleSection.className = 'module-section';
                
                const moduleHeader = document.createElement('div');
                moduleHeader.className = 'module-header';
                moduleHeader.textContent = `M√≥dulo ${module.id}: ${module.name}`;
                moduleSection.appendChild(moduleHeader);
                
                const lessonGrid = document.createElement('div');
                lessonGrid.className = 'lesson-grid';
                
                module.lessons.forEach(lesson => {
                    const card = document.createElement('div');
                    card.className = 'lesson-card';
                    if (completed.includes(lesson.id)) {
                        card.classList.add('completed');
                    }
                    
                    card.innerHTML = `
                        <h3>
                            <span class="status">${completed.includes(lesson.id) ? '‚úÖ' : 'üìò'}</span>
                            Lecci√≥n ${lesson.id}
                        </h3>
                        <h4>${lesson.title}</h4>
                        <p>${lesson.description}</p>
                    `;
                    
                    card.addEventListener('click', () => toggleLesson(lesson.id));
                    lessonGrid.appendChild(card);
                });
                
                moduleSection.appendChild(lessonGrid);
                container.appendChild(moduleSection);
            });
        }

        // Toggle Lesson Completion
        function toggleLesson(lessonId) {
            const completed = getCompleted();
            const index = completed.indexOf(lessonId);
            
            if (index === -1) {
                completed.push(lessonId);
                logActivity(`Lecci√≥n ${lessonId} completada`);
            } else {
                completed.splice(index, 1);
                logActivity(`Lecci√≥n ${lessonId} marcada como incompleta`);
            }
            
            saveCompleted(completed);
            renderLessons();
            updateStats();
        }

        // Render Quiz
        function renderQuiz() {
            const container = document.getElementById('quizQuestions');
            container.innerHTML = '';
            
            COURSE.quiz.forEach(question => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'quiz-question';
                
                let optionsHTML = '';
                question.options.forEach((option, index) => {
                    optionsHTML += `
                        <label class="quiz-option">
                            <input type="radio" name="q${question.id}" value="${index}" required>
                            <span>${option}</span>
                        </label>
                    `;
                });
                
                questionDiv.innerHTML = `
                    <div class="question-number">Pregunta ${question.id} de ${COURSE.quiz.length}</div>
                    <div class="question-text">${question.question}</div>
                    <div class="quiz-options">
                        ${optionsHTML}
                    </div>
                `;
                
                container.appendChild(questionDiv);
            });
            
            document.getElementById('quizForm').addEventListener('submit', submitQuiz);
        }

        // Submit Quiz
        function submitQuiz(e) {
            e.preventDefault();
            
            let correct = 0;
            const answers = [];
            
            COURSE.quiz.forEach(question => {
                const selected = document.querySelector(`input[name="q${question.id}"]:checked`);
                if (selected) {
                    const answer = parseInt(selected.value);
                    answers.push(answer);
                    if (answer === question.correct) {
                        correct++;
                    }
                }
            });
            
            const score = Math.round((correct / COURSE.quiz.length) * 100);
            
            // Save result
            const results = getResults();
            results.push({
                score: score,
                correct: correct,
                total: COURSE.quiz.length,
                answers: answers,
                timestamp: new Date().toISOString()
            });
            saveResults(results);
            
            // Log activity
            logActivity(`Cuestionario completado: ${score}%`);
            
            // Show result
            const resultDiv = document.getElementById('quizResult');
            resultDiv.innerHTML = `
                <div class="quiz-result">
                    <h2>¬°Cuestionario Completado!</h2>
                    <div class="score">${score}%</div>
                    <p>Respondiste correctamente ${correct} de ${COURSE.quiz.length} preguntas.</p>
                    <button class="btn btn-primary" onclick="retakeQuiz()">Tomar de Nuevo</button>
                </div>
            `;
            resultDiv.style.display = 'block';
            document.getElementById('quizForm').style.display = 'none';
            
            updateStats();
        }

        // Retake Quiz
        function retakeQuiz() {
            document.getElementById('quizForm').reset();
            document.getElementById('quizForm').style.display = 'block';
            document.getElementById('quizResult').style.display = 'none';
        }

        // Update Stats
        function updateStats() {
            const completed = getCompleted();
            const results = getResults();
            const totalLessons = COURSE.modules.reduce((sum, m) => sum + m.lessons.length, 0);
            
            const completedCount = completed.length;
            const progress = Math.round((completedCount / totalLessons) * 100);
            
            let bestScore = '-';
            if (results.length > 0) {
                bestScore = Math.max(...results.map(r => r.score)) + '%';
            }
            
            // Update overview stats
            document.getElementById('completedCount').textContent = `${completedCount}/${totalLessons}`;
            document.getElementById('quizScore').textContent = bestScore;
            document.getElementById('totalProgress').textContent = progress + '%';
            
            // Update progress bar
            const progressBar = document.getElementById('lessonProgress');
            if (progressBar) {
                progressBar.style.width = progress + '%';
                progressBar.textContent = progress + '%';
            }
        }

        // Update Progress Tab
        function updateProgressTab() {
            const completed = getCompleted();
            const results = getResults();
            const totalLessons = COURSE.modules.reduce((sum, m) => sum + m.lessons.length, 0);
            
            const completedCount = completed.length;
            const progress = Math.round((completedCount / totalLessons) * 100);
            
            let bestScore = '-';
            if (results.length > 0) {
                bestScore = Math.max(...results.map(r => r.score)) + '%';
            }
            
            document.getElementById('progressCompletedCount').textContent = `${completedCount}/${totalLessons}`;
            document.getElementById('progressBestScore').textContent = bestScore;
            document.getElementById('progressQuizAttempts').textContent = results.length;
            document.getElementById('progressOverall').textContent = progress + '%';
            
            // Update activity log
            updateActivityLog();
        }

        // Update Activity Log
        function updateActivityLog() {
            const activity = getActivity();
            const container = document.getElementById('activityLog');
            container.innerHTML = '';
            
            if (activity.length === 0) {
                container.innerHTML = '<p>No hay actividad registrada a√∫n.</p>';
                return;
            }
            
            activity.slice(-10).reverse().forEach(item => {
                const activityItem = document.createElement('div');
                activityItem.className = 'activity-item';
                
                const date = new Date(item.timestamp);
                const timeStr = date.toLocaleDateString('es-ES') + ' ' + date.toLocaleTimeString('es-ES');
                
                activityItem.innerHTML = `
                    <strong>${item.action}</strong>
                    <div class="time">${timeStr}</div>
                `;
                container.appendChild(activityItem);
            });
        }

        // Export as JSON
        function exportAsJSON() {
            const data = {
                completed: getCompleted(),
                results: getResults(),
                activity: getActivity(),
                exportDate: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `pl300-progress-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            logActivity('Progreso exportado como JSON');
        }

        // Export as CSV
        function exportAsCSV() {
            const completed = getCompleted();
            const results = getResults();
            
            let csv = 'Tipo,Valor,Fecha\n';
            
            completed.forEach(lessonId => {
                csv += `Lecci√≥n Completada,${lessonId},\n`;
            });
            
            results.forEach(result => {
                csv += `Cuestionario,${result.score}%,${new Date(result.timestamp).toLocaleDateString('es-ES')}\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `pl300-progress-${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            URL.revokeObjectURL(url);
            
            logActivity('Progreso exportado como CSV');
        }

        // Clear Progress
        function clearProgress() {
            if (confirm('¬øEst√°s seguro de que deseas eliminar todo tu progreso? Esta acci√≥n no se puede deshacer.')) {
                localStorage.removeItem(STORAGE_KEYS.completed);
                localStorage.removeItem(STORAGE_KEYS.results);
                localStorage.removeItem('pl300-activity');
                
                renderLessons();
                updateStats();
                updateProgressTab();
                
                alert('Todo el progreso ha sido eliminado.');
            }
        }

        // Local Storage Helpers
        function getCompleted() {
            const data = localStorage.getItem(STORAGE_KEYS.completed);
            return data ? JSON.parse(data) : [];
        }

        function saveCompleted(completed) {
            localStorage.setItem(STORAGE_KEYS.completed, JSON.stringify(completed));
        }

        function getResults() {
            const data = localStorage.getItem(STORAGE_KEYS.results);
            return data ? JSON.parse(data) : [];
        }

        function saveResults(results) {
            localStorage.setItem(STORAGE_KEYS.results, JSON.stringify(results));
        }

        function getActivity() {
            const data = localStorage.getItem('pl300-activity');
            return data ? JSON.parse(data) : [];
        }

        function logActivity(action) {
            const activity = getActivity();
            activity.push({
                action: action,
                timestamp: new Date().toISOString()
            });
            localStorage.setItem('pl300-activity', JSON.stringify(activity));
        }
    </script>
</body>
</html>
